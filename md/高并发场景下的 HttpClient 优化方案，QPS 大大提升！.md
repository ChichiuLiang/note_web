> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/gxaECvqR3yCql34n6yRzHg)

> ğŸ‘‰Â **è¿™æ˜¯ä¸€ä¸ªæˆ–è®¸å¯¹ä½ æœ‰ç”¨****çš„ç¤¾ç¾¤**
> 
> ğŸ±Â ä¸€å¯¹ä¸€äº¤æµ / é¢è¯•å°å†Œ / ç®€å†ä¼˜åŒ– / æ±‚èŒè§£æƒ‘ï¼Œæ¬¢è¿åŠ å…¥ã€Œ[**èŠ‹é“å¿«é€Ÿå¼€å‘å¹³å°**](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247576697&idx=1&sn=a5f8a37fe0c6f05509c5bed6244471a8&chksm=fa4bd3c8cd3c5aded28a6b68a9944ce671f3d2748644f71550c0468d75058e90dd378a1babe8&scene=21#wechat_redirect)ã€çŸ¥è¯†æ˜Ÿçƒã€‚ä¸‹é¢æ˜¯æ˜Ÿçƒæä¾›çš„éƒ¨åˆ†èµ„æ–™ï¼šÂ 
> 
> *   [ã€Šé¡¹ç›®å®æˆ˜ï¼ˆè§†é¢‘ï¼‰ã€‹](http://mp.weixin.qq.com/s?__biz=MzUxOTc4NjEyMw==&mid=2247561735&idx=1&sn=1b0a95d87fc647c3cf5e2b88576a8f55&chksm=f9f7e9e3ce8060f5809daa189fea465e95fa5445797f96fd8023f424c2acf4d31751a62792fc&scene=21#wechat_redirect)ï¼šä»ä¹¦ä¸­å­¦ï¼Œå¾€äº‹ä¸­ **â€œç»ƒâ€**
>     
> *   [ã€Šäº’è”ç½‘é«˜é¢‘é¢è¯•é¢˜ã€‹](http://mp.weixin.qq.com/s?__biz=MzUxOTc4NjEyMw==&mid=2247561735&idx=1&sn=1b0a95d87fc647c3cf5e2b88576a8f55&chksm=f9f7e9e3ce8060f5809daa189fea465e95fa5445797f96fd8023f424c2acf4d31751a62792fc&scene=21#wechat_redirect)ï¼šé¢æœç®€å†å­¦ä¹ ï¼Œæ˜¥æš–èŠ±å¼€
>     
> *   [ã€Šæ¶æ„ x ç³»ç»Ÿè®¾è®¡ã€‹](http://mp.weixin.qq.com/s?__biz=MzUxOTc4NjEyMw==&mid=2247561735&idx=1&sn=1b0a95d87fc647c3cf5e2b88576a8f55&chksm=f9f7e9e3ce8060f5809daa189fea465e95fa5445797f96fd8023f424c2acf4d31751a62792fc&scene=21#wechat_redirect)ï¼šæ‘§æ¯æ‹‰æœ½ï¼ŒæŒæ§é¢è¯•é«˜é¢‘åœºæ™¯é¢˜
>     
> *   [ã€Šç²¾è¿› Java å­¦ä¹ æŒ‡å—ã€‹](http://mp.weixin.qq.com/s?__biz=MzUxOTc4NjEyMw==&mid=2247561735&idx=1&sn=1b0a95d87fc647c3cf5e2b88576a8f55&chksm=f9f7e9e3ce8060f5809daa189fea465e95fa5445797f96fd8023f424c2acf4d31751a62792fc&scene=21#wechat_redirect)ï¼šç³»ç»Ÿå­¦ä¹ ï¼Œäº’è”ç½‘ä¸»æµæŠ€æœ¯æ ˆ
>     
> *   [ã€Šå¿…è¯» Java æºç ä¸“æ ã€‹](http://mp.weixin.qq.com/s?__biz=MzUxOTc4NjEyMw==&mid=2247561735&idx=1&sn=1b0a95d87fc647c3cf5e2b88576a8f55&chksm=f9f7e9e3ce8060f5809daa189fea465e95fa5445797f96fd8023f424c2acf4d31751a62792fc&scene=21#wechat_redirect)ï¼šçŸ¥å…¶ç„¶ï¼ŒçŸ¥å…¶æ‰€ä»¥ç„¶
>     

![](https://mmbiz.qpic.cn/mmbiz_gif/JdLkEI9sZfdWPYr0VKaXztEGHacpRyle7tbZkryrsxIpnAfjRt03ibrcloEZqlRPaVKcb0nD2PrYjtovwOAaFlA/640?wx_fmt=gif)

> ğŸ‘‰**è¿™æ˜¯ä¸€ä¸ªæˆ–è®¸å¯¹ä½ æœ‰ç”¨çš„å¼€æºé¡¹ç›®**
> 
> å›½äº§ Star ç ´ 10w+ çš„å¼€æºé¡¹ç›®ï¼Œå‰ç«¯åŒ…æ‹¬ç®¡ç†åå° + å¾®ä¿¡å°ç¨‹åºï¼Œåç«¯æ”¯æŒå•ä½“å’Œå¾®æœåŠ¡æ¶æ„ã€‚
> 
> åŠŸèƒ½æ¶µç›– RBAC æƒé™ã€SaaS å¤šç§Ÿæˆ·ã€æ•°æ®æƒé™ã€å•†åŸã€æ”¯ä»˜ã€å·¥ä½œæµã€å¤§å±æŠ¥è¡¨ã€å¾®ä¿¡å…¬ä¼—å·ç­‰ç­‰åŠŸèƒ½ï¼š
> 
> *   Boot ä»“åº“ï¼šhttps://gitee.com/zhijiantianya/ruoyi-vue-pro
>     
> *   Cloud ä»“åº“ï¼šhttps://gitee.com/zhijiantianya/yudao-cloud
>     
> *   è§†é¢‘æ•™ç¨‹ï¼šhttps://doc.iocoder.cn
>     
> 
> ã€å›½å†…é¦–æ‰¹ã€‘æ”¯æŒ JDK 21Â + SpringBoot 3.2.2ã€JDK 8 + Spring Boot 2.7.18 åŒç‰ˆæœ¬Â 

[æ¥æºï¼šblog.csdn.net/u010285974  
/article/details/85696239](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

*   [1. èƒŒæ™¯](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    
*   [2. åˆ†æ](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    

*   [2.1 httpclient åå¤åˆ›å»ºå¼€é”€](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    
*   [2.2 åå¤åˆ›å»º tcp è¿æ¥çš„å¼€é”€](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    
*   [2.3 é‡å¤ç¼“å­˜ entity çš„å¼€é”€](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    

*   [3. å®ç°](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    

*   [3.1 å®šä¹‰ä¸€ä¸ª keep alive strategy](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    
*   [3.2 é…ç½®ä¸€ä¸ª PoolingHttpClientConnectionManager](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    
*   [3.3 ç”Ÿæˆ httpclient](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    
*   [3.4 ä½¿ç”¨ httpclient æ‰§è¡Œ method æ—¶é™ä½å¼€é”€](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    

*   [4. å…¶ä»–](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    

*   [4.1 httpclient çš„ä¸€äº›è¶…æ—¶é…ç½®](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    
*   [4.2 å¦‚æœé…ç½®äº† nginx çš„è¯ï¼Œnginx ä¹Ÿè¦è®¾ç½®é¢å‘ä¸¤ç«¯çš„ keep-alive](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    

![](https://mmbiz.qpic.cn/mmbiz_jpg/6mychickmupUjNwwbOJP8GGFgFicUMbdmS3r8bUtm6nhvFaIXNtjWEK9opuAic1icXLZZjGPfa4G4F67qHjibszUjyQ/640?wx_fmt=jpeg&from=appmsg)

* * *

HttpClient ä¼˜åŒ–æ€è·¯ï¼š

1.  æ± åŒ–
    
2.  é•¿è¿æ¥
    
3.  httpclient å’Œ httpget å¤ç”¨
    
4.  åˆç†çš„é…ç½®å‚æ•°ï¼ˆæœ€å¤§å¹¶å‘è¯·æ±‚æ•°ï¼Œå„ç§è¶…æ—¶æ—¶é—´ï¼Œé‡è¯•æ¬¡æ•°ï¼‰
    
5.  å¼‚æ­¥
    
6.  å¤šè¯»æºç 
    

[1. èƒŒæ™¯](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)
--------------------------------------------------------------------------------------------------------------------------------------------

æˆ‘ä»¬æœ‰ä¸ªä¸šåŠ¡ï¼Œä¼šè°ƒç”¨å…¶ä»–éƒ¨é—¨æä¾›çš„ä¸€ä¸ªåŸºäº http çš„æœåŠ¡ï¼Œæ—¥è°ƒç”¨é‡åœ¨åƒä¸‡çº§åˆ«ã€‚ä½¿ç”¨äº† httpclient æ¥å®Œæˆä¸šåŠ¡ã€‚ä¹‹å‰å› ä¸º qps ä¸Šä¸å»ï¼Œå°±çœ‹äº†ä¸€ä¸‹ä¸šåŠ¡ä»£ç ï¼Œå¹¶åšäº†ä¸€äº›ä¼˜åŒ–ï¼Œè®°å½•åœ¨è¿™é‡Œã€‚

å…ˆå¯¹æ¯”å‰åï¼šä¼˜åŒ–ä¹‹å‰ï¼Œå¹³å‡æ‰§è¡Œæ—¶é—´æ˜¯ 250msï¼›

ä¼˜åŒ–ä¹‹åï¼Œå¹³å‡æ‰§è¡Œæ—¶é—´æ˜¯ 80msï¼Œé™ä½äº†ä¸‰åˆ†ä¹‹äºŒçš„æ¶ˆè€—ï¼Œå®¹å™¨ä¸å†åŠ¨ä¸åŠ¨å°±æŠ¥è­¦çº¿ç¨‹è€—å°½äº†ï¼Œæ¸…çˆ½~

> åŸºäº Spring Boot + MyBatis Plus + Vue & Element å®ç°çš„åå°ç®¡ç†ç³»ç»Ÿ + ç”¨æˆ·å°ç¨‹åºï¼Œæ”¯æŒ RBAC åŠ¨æ€æƒé™ã€å¤šç§Ÿæˆ·ã€æ•°æ®æƒé™ã€å·¥ä½œæµã€ä¸‰æ–¹ç™»å½•ã€æ”¯ä»˜ã€çŸ­ä¿¡ã€å•†åŸç­‰åŠŸèƒ½
> 
> *   é¡¹ç›®åœ°å€ï¼šhttps://github.com/YunaiV/ruoyi-vue-pro
>     
> *   è§†é¢‘æ•™ç¨‹ï¼šhttps://doc.iocoder.cn/video/
>     

[2. åˆ†æ](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)
--------------------------------------------------------------------------------------------------------------------------------------------

é¡¹ç›®çš„åŸå®ç°æ¯”è¾ƒç²—ç•¥ï¼Œå°±æ˜¯æ¯æ¬¡è¯·æ±‚æ—¶åˆå§‹åŒ–ä¸€ä¸ª httpclientï¼Œç”Ÿæˆä¸€ä¸ª httpPost å¯¹è±¡ï¼Œæ‰§è¡Œï¼Œç„¶åä»è¿”å›ç»“æœå–å‡º entityï¼Œä¿å­˜æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæœ€åæ˜¾å¼å…³é—­ response å’Œ clientã€‚

æˆ‘ä»¬ä¸€ç‚¹ç‚¹åˆ†æå’Œä¼˜åŒ–ï¼š

### [2.1 httpclient åå¤åˆ›å»ºå¼€é”€](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

httpclient æ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œæ²¡æœ‰å¿…è¦ç”±æ¯ä¸ªçº¿ç¨‹åœ¨æ¯æ¬¡ä½¿ç”¨æ—¶åˆ›å»ºï¼Œå…¨å±€ä¿ç•™ä¸€ä¸ªå³å¯ã€‚

### [2.2 åå¤åˆ›å»º tcp è¿æ¥çš„å¼€é”€](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

tcp çš„ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹ä¸¤å¤§è£¹è„šå¸ƒè¿‡ç¨‹ï¼Œå¯¹äºé«˜é¢‘æ¬¡çš„è¯·æ±‚æ¥è¯´ï¼Œæ¶ˆè€—å®åœ¨å¤ªå¤§ã€‚è¯•æƒ³å¦‚æœæ¯æ¬¡è¯·æ±‚æˆ‘ä»¬éœ€è¦èŠ±è´¹ 5ms ç”¨äºåå•†è¿‡ç¨‹ï¼Œé‚£ä¹ˆå¯¹äº qps ä¸º 100 çš„å•ç³»ç»Ÿï¼Œ1 ç§’é’Ÿæˆ‘ä»¬å°±è¦èŠ± 500ms ç”¨äºæ¡æ‰‹å’ŒæŒ¥æ‰‹ã€‚åˆä¸æ˜¯é«˜çº§é¢†å¯¼ï¼Œæˆ‘ä»¬ç¨‹åºå‘˜å°±ä¸è¦æè¿™ä¹ˆå¤§åšæ´¾äº†ï¼Œæ”¹æˆ keep alive æ–¹å¼ä»¥å®ç°è¿æ¥å¤ç”¨ï¼

### [2.3 é‡å¤ç¼“å­˜ entity çš„å¼€é”€](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

åŸæœ¬çš„é€»è¾‘é‡Œï¼Œä½¿ç”¨äº†å¦‚ä¸‹ä»£ç ï¼š

```
HttpEntityÂ entityÂ =Â httpResponse.getEntity();

StringÂ responseÂ =Â EntityUtils.toString(entity);


```

è¿™é‡Œæˆ‘ä»¬ç›¸å½“äºé¢å¤–å¤åˆ¶äº†ä¸€ä»½ content åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²é‡Œï¼Œè€ŒåŸæœ¬çš„ httpResponse ä»ç„¶ä¿ç•™äº†ä¸€ä»½ contentï¼Œéœ€è¦è¢« consume æ‰ï¼Œåœ¨é«˜å¹¶å‘ä¸” content éå¸¸å¤§çš„æƒ…å†µä¸‹ï¼Œä¼šæ¶ˆè€—å¤§é‡å†…å­˜ã€‚å¹¶ä¸”ï¼Œæˆ‘ä»¬éœ€è¦æ˜¾å¼çš„å…³é—­è¿æ¥ï¼Œuglyã€‚

> åŸºäº Spring Cloud Alibaba + Gateway + Nacos + RocketMQ + Vue & Element å®ç°çš„åå°ç®¡ç†ç³»ç»Ÿ + ç”¨æˆ·å°ç¨‹åºï¼Œæ”¯æŒ RBAC åŠ¨æ€æƒé™ã€å¤šç§Ÿæˆ·ã€æ•°æ®æƒé™ã€å·¥ä½œæµã€ä¸‰æ–¹ç™»å½•ã€æ”¯ä»˜ã€çŸ­ä¿¡ã€å•†åŸç­‰åŠŸèƒ½
> 
> *   é¡¹ç›®åœ°å€ï¼šhttps://github.com/YunaiV/yudao-cloud
>     
> *   è§†é¢‘æ•™ç¨‹ï¼šhttps://doc.iocoder.cn/video/
>     

[3. å®ç°](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)
--------------------------------------------------------------------------------------------------------------------------------------------

æŒ‰ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬ä¸»è¦è¦åšä¸‰ä»¶äº‹ï¼šä¸€æ˜¯å•ä¾‹çš„ clientï¼ŒäºŒæ˜¯ç¼“å­˜çš„ä¿æ´»è¿æ¥ï¼Œä¸‰æ˜¯æ›´å¥½çš„å¤„ç†è¿”å›ç»“æœã€‚ä¸€å°±ä¸è¯´äº†ï¼Œæ¥è¯´è¯´äºŒã€‚

æåˆ°è¿æ¥ç¼“å­˜ï¼Œå¾ˆå®¹æ˜“è”æƒ³åˆ°æ•°æ®åº“è¿æ¥æ± ã€‚httpclient4 æä¾›äº†ä¸€ä¸ª PoolingHttpClientConnectionManager ä½œä¸ºè¿æ¥æ± ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹æ­¥éª¤æ¥ä¼˜åŒ–ï¼š

### [3.1 å®šä¹‰ä¸€ä¸ª keep alive strategy](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

å…³äº keep-aliveï¼Œæœ¬æ–‡ä¸å±•å¼€è¯´æ˜ï¼Œåªæä¸€ç‚¹ï¼Œæ˜¯å¦ä½¿ç”¨ keep-alive è¦æ ¹æ®ä¸šåŠ¡æƒ…å†µæ¥å®šï¼Œå®ƒå¹¶ä¸æ˜¯çµä¸¹å¦™è¯ã€‚è¿˜æœ‰ä¸€ç‚¹ï¼Œkeep-alive å’Œ time_wait/close_wait ä¹‹é—´ä¹Ÿæœ‰ä¸å°‘æ•…äº‹ã€‚

åœ¨æœ¬ä¸šåŠ¡åœºæ™¯é‡Œï¼Œæˆ‘ä»¬ç›¸å½“äºæœ‰å°‘æ•°å›ºå®šå®¢æˆ·ç«¯ï¼Œé•¿æ—¶é—´æé«˜é¢‘æ¬¡çš„è®¿é—®æœåŠ¡å™¨ï¼Œå¯ç”¨ keep-alive éå¸¸åˆé€‚

å†å¤šæä¸€å˜´ï¼Œhttp çš„ keep-alive å’Œ tcp çš„ KEEPALIVE ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ã€‚å›åˆ°æ­£æ–‡ï¼Œå®šä¹‰ä¸€ä¸ª strategy å¦‚ä¸‹ï¼š

```
ConnectionKeepAliveStrategyÂ myStrategyÂ =Â newÂ ConnectionKeepAliveStrategy()Â {
Â Â Â Â @Override
Â Â Â Â publicÂ longÂ getKeepAliveDuration(HttpResponseÂ response,Â HttpContextÂ context)Â {
Â Â Â Â Â Â Â Â HeaderElementIteratorÂ itÂ =Â newÂ BasicHeaderElementIterator
Â Â Â Â Â Â Â Â Â Â Â Â (response.headerIterator(HTTP.CONN_KEEP_ALIVE));
Â Â Â Â Â Â Â Â whileÂ (it.hasNext())Â {
Â Â Â Â Â Â Â Â Â Â Â Â HeaderElementÂ heÂ =Â it.nextElement();
Â Â Â Â Â Â Â Â Â Â Â Â StringÂ paramÂ =Â he.getName();
Â Â Â Â Â Â Â Â Â Â Â Â StringÂ valueÂ =Â he.getValue();
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (valueÂ !=Â nullÂ &&Â param.equalsIgnoreCase
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ("timeout"))Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ Long.parseLong(value)Â *Â 1000;
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â returnÂ 60Â *Â 1000;//å¦‚æœæ²¡æœ‰çº¦å®šï¼Œåˆ™é»˜è®¤å®šä¹‰æ—¶é•¿ä¸º60s
Â Â Â Â }
};


```

### [3.2 é…ç½®ä¸€ä¸ª PoolingHttpClientConnectionManager](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

```
PoolingHttpClientConnectionManagerÂ connectionManagerÂ =Â newÂ PoolingHttpClientConnectionManager();
connectionManager.setMaxTotal(500);
connectionManager.setDefaultMaxPerRoute(50);//ä¾‹å¦‚é»˜è®¤æ¯è·¯ç”±æœ€é«˜50å¹¶å‘ï¼Œå…·ä½“ä¾æ®ä¸šåŠ¡æ¥å®š


```

ä¹Ÿå¯ä»¥é’ˆå¯¹æ¯ä¸ªè·¯ç”±è®¾ç½®å¹¶å‘æ•°ã€‚

### [3.3 ç”Ÿæˆ httpclient](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

```
httpClientÂ =Â HttpClients.custom()
Â Â Â Â Â .setConnectionManager(connectionManager)
Â Â Â Â Â .setKeepAliveStrategy(kaStrategy)
Â Â Â Â Â .setDefaultRequestConfig(RequestConfig.custom().setStaleConnectionCheckEnabled(true).build())
Â Â Â Â Â .build();


```

> â
> 
> æ³¨æ„ï¼šä½¿ç”¨ setStaleConnectionCheckEnabled æ–¹æ³•æ¥é€å‡ºå·²è¢«å…³é—­çš„é“¾æ¥ä¸è¢«æ¨èã€‚æ›´å¥½çš„æ–¹å¼æ˜¯æ‰‹åŠ¨å¯ç”¨ä¸€ä¸ªçº¿ç¨‹ï¼Œå®šæ—¶è¿è¡Œ closeExpiredConnections å’Œ closeIdleConnections æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
> 
> â

```
publicÂ staticÂ classÂ IdleConnectionMonitorThreadÂ extendsÂ ThreadÂ {
Â Â Â Â 
Â Â Â Â privateÂ finalÂ HttpClientConnectionManagerÂ connMgr;
Â Â Â Â privateÂ volatileÂ booleanÂ shutdown;
Â Â Â Â 
Â Â Â Â publicÂ IdleConnectionMonitorThread(HttpClientConnectionManagerÂ connMgr)Â {
Â Â Â Â Â Â Â Â super();
Â Â Â Â Â Â Â Â this.connMgrÂ =Â connMgr;
Â Â Â Â }
Â 
Â Â Â Â @Override
Â Â Â Â publicÂ voidÂ run()Â {
Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â whileÂ (!shutdown)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â synchronizedÂ (this)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â wait(5000);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â CloseÂ expiredÂ connections
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â connMgr.closeExpiredConnections();
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â Optionally,Â closeÂ connections
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â thatÂ haveÂ beenÂ idleÂ longerÂ thanÂ 30Â sec
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â connMgr.closeIdleConnections(30,Â TimeUnit.SECONDS);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ ex)Â {
Â Â Â Â Â Â Â Â Â Â Â Â //Â terminate
Â Â Â Â Â Â Â Â }
Â Â Â Â }
Â Â Â Â 
Â Â Â Â publicÂ voidÂ shutdown()Â {
Â Â Â Â Â Â Â Â shutdownÂ =Â true;
Â Â Â Â Â Â Â Â synchronizedÂ (this)Â {
Â Â Â Â Â Â Â Â Â Â Â Â notifyAll();
Â Â Â Â Â Â Â Â }
Â Â Â Â }
Â Â Â Â 
}


```

### [3.4 ä½¿ç”¨ httpclient æ‰§è¡Œ method æ—¶é™ä½å¼€é”€](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

> â
> 
> è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œä¸è¦å…³é—­ connectionã€‚
> 
> â

ä¸€ç§å¯è¡Œçš„è·å–å†…å®¹çš„æ–¹å¼ç±»ä¼¼äºï¼ŒæŠŠ entity é‡Œçš„ä¸œè¥¿å¤åˆ¶ä¸€ä»½ï¼š

```
resÂ =Â EntityUtils.toString(response.getEntity(),"UTF-8");
EntityUtils.consume(response1.getEntity());


```

ä½†æ˜¯ï¼Œæ›´æ¨èçš„æ–¹å¼æ˜¯å®šä¹‰ä¸€ä¸ª ResponseHandlerï¼Œæ–¹ä¾¿ä½ æˆ‘ä»–ï¼Œä¸å†è‡ªå·± catch å¼‚å¸¸å’Œå…³é—­æµã€‚åœ¨æ­¤æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ç›¸å…³çš„æºç ï¼š

```
publicÂ <T>Â TÂ execute(finalÂ HttpHostÂ target,Â finalÂ HttpRequestÂ request,
Â Â Â Â Â Â Â Â finalÂ ResponseHandler<?Â extendsÂ T>Â responseHandler,Â finalÂ HttpContextÂ context)
Â Â Â Â Â Â Â Â throwsÂ IOException,Â ClientProtocolExceptionÂ {
Â Â Â Â Args.notNull(responseHandler,Â "ResponseÂ handler");

Â Â Â Â finalÂ HttpResponseÂ responseÂ =Â execute(target,Â request,Â context);

Â Â Â Â finalÂ TÂ result;
Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â resultÂ =Â responseHandler.handleResponse(response);
Â Â Â Â }Â catchÂ (finalÂ ExceptionÂ t)Â {
Â Â Â Â Â Â Â Â finalÂ HttpEntityÂ entityÂ =Â response.getEntity();
Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â EntityUtils.consume(entity);
Â Â Â Â Â Â Â Â }Â catchÂ (finalÂ ExceptionÂ t2)Â {
Â Â Â Â Â Â Â Â Â Â Â Â //Â LogÂ thisÂ exception.Â TheÂ originalÂ exceptionÂ isÂ more
Â Â Â Â Â Â Â Â Â Â Â Â //Â importantÂ andÂ willÂ beÂ thrownÂ toÂ theÂ caller.
Â Â Â Â Â Â Â Â Â Â Â Â this.log.warn("ErrorÂ consumingÂ contentÂ afterÂ anÂ exception.",Â t2);
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â ifÂ (tÂ instanceofÂ RuntimeException)Â {
Â Â Â Â Â Â Â Â Â Â Â Â throwÂ (RuntimeException)Â t;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â ifÂ (tÂ instanceofÂ IOException)Â {
Â Â Â Â Â Â Â Â Â Â Â Â throwÂ (IOException)Â t;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â throwÂ newÂ UndeclaredThrowableException(t);
Â Â Â Â }

Â Â Â Â //Â HandlingÂ theÂ responseÂ wasÂ successful.Â EnsureÂ thatÂ theÂ contentÂ has
Â Â Â Â //Â beenÂ fullyÂ consumed.
Â Â Â Â finalÂ HttpEntityÂ entityÂ =Â response.getEntity();
Â Â Â Â EntityUtils.consume(entity);//çœ‹è¿™é‡Œçœ‹è¿™é‡Œ
Â Â Â Â returnÂ result;
}


```

å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ resultHandler æ‰§è¡Œ execute æ–¹æ³•ï¼Œä¼šæœ€ç»ˆè‡ªåŠ¨è°ƒç”¨ consume æ–¹æ³•ï¼Œè€Œè¿™ä¸ª consume æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š

```
publicÂ staticÂ voidÂ consume(finalÂ HttpEntityÂ entity)Â throwsÂ IOExceptionÂ {
Â Â Â Â ifÂ (entityÂ ==Â null)Â {
Â Â Â Â Â Â Â Â return;
Â Â Â Â }
Â Â Â Â ifÂ (entity.isStreaming())Â {
Â Â Â Â Â Â Â Â finalÂ InputStreamÂ instreamÂ =Â entity.getContent();
Â Â Â Â Â Â Â Â ifÂ (instreamÂ !=Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â instream.close();
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}


```

å¯ä»¥çœ‹åˆ°æœ€ç»ˆå®ƒå…³é—­äº†è¾“å…¥æµã€‚

[4. å…¶ä»–](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)
--------------------------------------------------------------------------------------------------------------------------------------------

é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼ŒåŸºæœ¬å°±å®Œæˆäº†ä¸€ä¸ªæ”¯æŒé«˜å¹¶å‘çš„ httpclient çš„å†™æ³•ï¼Œä¸‹é¢æ˜¯ä¸€äº›é¢å¤–çš„é…ç½®å’Œæé†’ï¼š

### [4.1 httpclient çš„ä¸€äº›è¶…æ—¶é…ç½®](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

CONNECTION_TIMEOUT æ˜¯è¿æ¥è¶…æ—¶æ—¶é—´ï¼ŒSO_TIMEOUT æ˜¯ socket è¶…æ—¶æ—¶é—´ï¼Œè¿™ä¸¤è€…æ˜¯ä¸åŒçš„ã€‚è¿æ¥è¶…æ—¶æ—¶é—´æ˜¯å‘èµ·è¯·æ±‚å‰çš„ç­‰å¾…æ—¶é—´ï¼›socket è¶…æ—¶æ—¶é—´æ˜¯ç­‰å¾…æ•°æ®çš„è¶…æ—¶æ—¶é—´ã€‚

```
HttpParamsÂ paramsÂ =Â newÂ BasicHttpParams();
//è®¾ç½®è¿æ¥è¶…æ—¶æ—¶é—´
IntegerÂ CONNECTION_TIMEOUTÂ =Â 2Â *Â 1000;Â //è®¾ç½®è¯·æ±‚è¶…æ—¶2ç§’é’ŸÂ æ ¹æ®ä¸šåŠ¡è°ƒæ•´
IntegerÂ SO_TIMEOUTÂ =Â 2Â *Â 1000;Â //è®¾ç½®ç­‰å¾…æ•°æ®è¶…æ—¶æ—¶é—´2ç§’é’ŸÂ æ ¹æ®ä¸šåŠ¡è°ƒæ•´
Â 
//å®šä¹‰äº†å½“ä»ClientConnectionManagerä¸­æ£€ç´¢ManagedClientConnectionå®ä¾‹æ—¶ä½¿ç”¨çš„æ¯«ç§’çº§çš„è¶…æ—¶æ—¶é—´
//è¿™ä¸ªå‚æ•°æœŸæœ›å¾—åˆ°ä¸€ä¸ªjava.lang.Longç±»å‹çš„å€¼ã€‚å¦‚æœè¿™ä¸ªå‚æ•°æ²¡æœ‰è¢«è®¾ç½®ï¼Œé»˜è®¤ç­‰äºCONNECTION_TIMEOUTï¼Œå› æ­¤ä¸€å®šè¦è®¾ç½®ã€‚
LongÂ CONN_MANAGER_TIMEOUTÂ =Â 500L;Â //åœ¨httpclient4.2.3ä¸­æˆ‘è®°å¾—å®ƒè¢«æ”¹æˆäº†ä¸€ä¸ªå¯¹è±¡å¯¼è‡´ç›´æ¥ç”¨longä¼šæŠ¥é”™ï¼Œåæ¥åˆæ”¹å›æ¥äº†
Â 
params.setIntParameter(CoreConnectionPNames.CONNECTION_TIMEOUT,Â CONNECTION_TIMEOUT);
params.setIntParameter(CoreConnectionPNames.SO_TIMEOUT,Â SO_TIMEOUT);
params.setLongParameter(ClientPNames.CONN_MANAGER_TIMEOUT,Â CONN_MANAGER_TIMEOUT);
//åœ¨æäº¤è¯·æ±‚ä¹‹å‰Â æµ‹è¯•è¿æ¥æ˜¯å¦å¯ç”¨
params.setBooleanParameter(CoreConnectionPNames.STALE_CONNECTION_CHECK,Â true);
Â 
//å¦å¤–è®¾ç½®httpÂ clientçš„é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤æ˜¯3æ¬¡ï¼›å½“å‰æ˜¯ç¦ç”¨æ‰ï¼ˆå¦‚æœé¡¹ç›®é‡ä¸åˆ°ï¼Œè¿™ä¸ªé»˜è®¤å³å¯ï¼‰
httpClient.setHttpRequestRetryHandler(newÂ DefaultHttpRequestRetryHandler(0,Â false));


```

### [4.2 å¦‚æœé…ç½®äº† nginx çš„è¯ï¼Œnginx ä¹Ÿè¦è®¾ç½®é¢å‘ä¸¤ç«¯çš„ keep-alive](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

ç°åœ¨çš„ä¸šåŠ¡é‡Œï¼Œæ²¡æœ‰ nginx çš„æƒ…å†µåè€Œæ¯”è¾ƒç¨€å°‘ã€‚nginx é»˜è®¤å’Œ client ç«¯æ‰“å¼€é•¿è¿æ¥è€Œå’Œ server ç«¯ä½¿ç”¨çŸ­é“¾æ¥ã€‚

> â
> 
> æ³¨æ„ client ç«¯çš„ keepalive_timeout å’Œ keepalive_requests å‚æ•°ï¼Œä»¥åŠ upstream ç«¯çš„ keepalive å‚æ•°è®¾ç½®ï¼Œè¿™ä¸‰ä¸ªå‚æ•°çš„æ„ä¹‰åœ¨æ­¤ä¹Ÿä¸å†èµ˜è¿°ã€‚
> 
> â

ä»¥ä¸Šå°±æ˜¯æˆ‘çš„å…¨éƒ¨è®¾ç½®ã€‚é€šè¿‡è¿™äº›è®¾ç½®ï¼ŒæˆåŠŸåœ°å°†åŸæœ¬æ¯æ¬¡è¯·æ±‚ 250ms çš„è€—æ—¶é™ä½åˆ°äº† 80 å·¦å³ï¼Œæ•ˆæœæ˜¾è‘—ã€‚

JAR åŒ…å¦‚ä¸‹ï¼š

```
<!--Â httpclientÂ -->
<dependency>
Â Â Â Â <groupId>org.apache.httpcomponents</groupId>
Â Â Â Â <artifactId>httpclient</artifactId>
Â Â Â Â <version>4.5.6</version>
</dependency>


```

ä»£ç å¦‚ä¸‹ï¼š

```
//Basicè®¤è¯
privateÂ staticÂ finalÂ CredentialsProviderÂ credsProviderÂ =Â newÂ BasicCredentialsProvider();
//httpClient
privateÂ staticÂ finalÂ CloseableHttpClientÂ httpclient;
//httpGetæ–¹æ³•
privateÂ staticÂ finalÂ HttpGetÂ httpget;
//
privateÂ staticÂ finalÂ RequestConfigÂ reqestConfig;
//å“åº”å¤„ç†å™¨
privateÂ staticÂ finalÂ ResponseHandler<String>Â responseHandler;
//jacksonè§£æå·¥å…·
privateÂ staticÂ finalÂ ObjectMapperÂ mapperÂ =Â newÂ ObjectMapper();
staticÂ {
Â Â Â Â System.setProperty("http.maxConnections","50");
Â Â Â Â System.setProperty("http.keepAlive",Â "true");
Â Â Â Â //è®¾ç½®basicæ ¡éªŒ
Â Â Â Â credsProvider.setCredentials(
Â Â Â Â Â Â Â Â Â Â Â Â newÂ AuthScope(AuthScope.ANY_HOST,Â AuthScope.ANY_PORT,Â AuthScope.ANY_REALM),
Â Â Â Â Â Â Â Â Â Â Â Â newÂ UsernamePasswordCredentials("",Â ""));
Â Â Â Â //åˆ›å»ºhttpå®¢æˆ·ç«¯
Â Â Â Â httpclientÂ =Â HttpClients.custom()
Â Â Â Â Â Â Â Â Â Â Â Â .useSystemProperties()
Â Â Â Â Â Â Â Â Â Â Â Â .setRetryHandler(newÂ DefaultHttpRequestRetryHandler(3,true))
Â Â Â Â Â Â Â Â Â Â Â Â .setDefaultCredentialsProvider(credsProvider)
Â Â Â Â Â Â Â Â Â Â Â Â .build();
Â Â Â Â //åˆå§‹åŒ–httpGet
Â Â Â Â httpgetÂ =Â newÂ HttpGet();
Â Â Â Â //åˆå§‹åŒ–HTTPè¯·æ±‚é…ç½®
Â Â Â Â reqestConfigÂ =Â RequestConfig.custom()
Â Â Â Â Â Â Â Â Â Â Â Â .setContentCompressionEnabled(true)
Â Â Â Â Â Â Â Â Â Â Â Â .setSocketTimeout(100)
Â Â Â Â Â Â Â Â Â Â Â Â .setAuthenticationEnabled(true)
Â Â Â Â Â Â Â Â Â Â Â Â .setConnectionRequestTimeout(100)
Â Â Â Â Â Â Â Â Â Â Â Â .setConnectTimeout(100).build();
Â Â Â Â httpget.setConfig(reqestConfig);
Â Â Â Â //åˆå§‹åŒ–responseè§£æå™¨
Â Â Â Â responseHandlerÂ =Â newÂ BasicResponseHandler();
}
/*
Â *Â åŠŸèƒ½ï¼šè¿”å›å“åº”
Â *Â @authorÂ zhangdaquan
Â *Â @paramÂ [url]
Â *Â @returnÂ org.apache.http.client.methods.CloseableHttpResponse
Â *Â @exception
Â */
publicÂ staticÂ StringÂ getResponse(StringÂ url)Â throwsÂ IOExceptionÂ {
Â Â Â Â HttpGetÂ getÂ =Â newÂ HttpGet(url);
Â Â Â Â StringÂ responseÂ =Â httpclient.execute(get,responseHandler);
Â Â Â Â returnÂ response;
}
Â 
/*
Â *Â åŠŸèƒ½ï¼šå‘é€httpè¯·æ±‚ï¼Œå¹¶ç”¨net.sf.jsonå·¥å…·è§£æ
Â *Â @authorÂ zhangdaquan
Â *Â @paramÂ [url]
Â *Â @returnÂ org.json.JSONObject
Â *Â @exception
Â */
publicÂ staticÂ JSONObjectÂ getUrl(StringÂ url)Â throwsÂ Exception{
Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â httpget.setURI(URI.create(url));
Â Â Â Â Â Â Â Â StringÂ responseÂ =Â httpclient.execute(httpget,responseHandler);
Â Â Â Â Â Â Â Â JSONObjectÂ jsonÂ =Â JSONObject.fromObject(response);
Â Â Â Â Â Â Â Â returnÂ json;
Â Â Â Â }Â catchÂ (IOExceptionÂ e)Â {
Â Â Â Â Â Â Â Â e.printStackTrace();
Â Â Â Â }
Â Â Â Â returnÂ null;
}
/*
Â *Â åŠŸèƒ½ï¼šå‘é€httpè¯·æ±‚ï¼Œå¹¶ç”¨jacksonå·¥å…·è§£æ
Â *Â @authorÂ zhangdaquan
Â *Â @paramÂ [url]
Â *Â @returnÂ com.fasterxml.jackson.databind.JsonNode
Â *Â @exception
Â */
publicÂ staticÂ JsonNodeÂ getUrl2(StringÂ url){
Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â httpget.setURI(URI.create(url));
Â Â Â Â Â Â Â Â StringÂ responseÂ =Â httpclient.execute(httpget,responseHandler);
Â Â Â Â Â Â Â Â JsonNodeÂ nodeÂ =Â mapper.readTree(response);
Â Â Â Â Â Â Â Â returnÂ node;
Â Â Â Â }Â catchÂ (IOExceptionÂ e)Â {
Â Â Â Â Â Â Â Â e.printStackTrace();
Â Â Â Â }
Â Â Â Â returnÂ null;
}
/*
Â *Â åŠŸèƒ½ï¼šå‘é€httpè¯·æ±‚ï¼Œå¹¶ç”¨fastjsonå·¥å…·è§£æ
Â *Â @authorÂ zhangdaquan
Â *Â @paramÂ [url]
Â *Â @returnÂ com.fasterxml.jackson.databind.JsonNode
Â *Â @exception
Â */
publicÂ staticÂ com.alibaba.fastjson.JSONObjectÂ getUrl3(StringÂ url){
Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â httpget.setURI(URI.create(url));
Â Â Â Â Â Â Â Â StringÂ responseÂ =Â httpclient.execute(httpget,responseHandler);
Â Â Â Â Â Â Â Â com.alibaba.fastjson.JSONObjectÂ jsonObjectÂ =Â com.alibaba.fastjson.JSONObject.parseObject(response);
Â Â Â Â Â Â Â Â returnÂ jsonObject;
Â Â Â Â }Â catchÂ (IOExceptionÂ e)Â {
Â Â Â Â Â Â Â Â e.printStackTrace();
Â Â Â Â }
Â Â Â Â returnÂ null;
}


```

* * *

æ¬¢è¿åŠ å…¥æˆ‘çš„çŸ¥è¯†æ˜Ÿçƒï¼Œå…¨é¢æå‡æŠ€æœ¯èƒ½åŠ›ã€‚

ğŸ‘‰Â åŠ å…¥æ–¹å¼ï¼Œ**â€œ**é•¿æŒ‰**â€ æˆ– â€œ**æ‰«æ**â€ ä¸‹æ–¹äºŒç»´ç å™¢**ï¼š

![](https://mmbiz.qpic.cn/mmbiz_png/6mychickmupUyQRGCOLQlJYyS47picY3OzaoUUJvwwrgEyR5U5fcYrCggDvjuDmAtibib1Zf6JjXlOic1PfvRCF2l4A/640?wx_fmt=png)

æ˜Ÿçƒçš„**å†…å®¹åŒ…æ‹¬**ï¼šé¡¹ç›®å®æˆ˜ã€é¢è¯•æ‹›è˜ã€æºç è§£æã€å­¦ä¹ è·¯çº¿ã€‚

![](https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfdWPYr0VKaXztEGHacpRyle64G451XsWx4Ufc9FHYmNTqFdKdtNhyjlhrEC7Pic1dRfue78ib3TiaKBg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfdWPYr0VKaXztEGHacpRylewlfAU6nBKS8tWSIrLcmSicsq0ECUIVnf0JHibsLARrp4Z3ZCh5oSvYMQ/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfdWPYr0VKaXztEGHacpRyleptHSrmBV71SbQSolzZpmdqN2q03yLwk1bwZYNu2lr17gFjO0rh1ZdQ/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfdWPYr0VKaXztEGHacpRyleYQLfl6qLTABQx5UrP0dXXv6cSv2TmBoouiciaZIXwyD88h5OIsM8lpkw/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfdWPYr0VKaXztEGHacpRyleicAvrkTkdGYRubqZdPNkqpoTmtOCQjkItotwtAbCxibsWUI4Dz0ILTEg/640?wx_fmt=png)

```
æ–‡ç« æœ‰å¸®åŠ©çš„è¯ï¼Œåœ¨çœ‹ï¼Œè½¬å‘å§ã€‚

è°¢è°¢æ”¯æŒå“Ÿ (*^__^*ï¼‰

```