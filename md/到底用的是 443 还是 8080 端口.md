

> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/soFSYx4mw7QbxhoEfasZJg)

你知道的越多，不知道的就越多，业余的像一棵小草！
------------------------

你来，我们一起精进！你不来，我和你的竞争对手一起精进！

编辑：业余草
------

推荐：https://t.zsxq.com/15N1RW8a1  

自律才能自由

最近微信群里，有一位网友给我转了一个问题：“https://localhost:8080 / 到底用的是 443 还是 8080 端口？”。

这个简单的问题，还有不少人回答错误。当然也有不少人是回答正确的。

![](https://mmbiz.qpic.cn/mmbiz_png/TLH3CicPVibreHY8WpkVKicI1qFOibic2bUVHNVnVq1XgdS1QLuEFKwBFQ8uwEx5PibtEicQQRdfiaL86OXXDiaePJrz9oQ/640?wx_fmt=png&from=appmsg)

我这里抽个时间，统一回复一下！

我先告诉大家答案，这里肯定使用的是 8080 端口。至于为什么？听我一一到来。

我们先反向思维思考一下。假设这里使用的是 443 端口，那么当访问`http://localhost:8080/`地址时，实际访问的是不是 80 端口？

如果是 80 端口，那么 url 地址中指定的端口是不是就不会生效。因为都走默认端口了。

而现实情况是，指定端口后，都走的是指定端口，而不是默认端口。这点不用多说，大家实际工作中都用到过。

所以，假设错误，假设是不成立的。

那么，答案就是显而易见的，题目中的问题，走的就是 8080 端口。

现在又来一个问题：为什么会在指定端口后，走指定端口呢？

哈哈，这里没有这么多为什么，因为这是 url 的设计规范和解析规范决定的。如果不这样，会发生什么？

我们先来回想一下，在浏览器地址栏键入 URL，按下回车之后会经历哪些流程。参考：[浏览器输入 URL 后究竟发生了什么？](http://mp.weixin.qq.com/s?__biz=MzIyODE5NjUwNQ==&mid=2653358988&idx=1&sn=0fd2361a60c353e5f48c37e46f92b135&chksm=f386027ac4f18b6cda3199676f337764776978bb31e75e656a855afafa814f7ccaba0b20e402&scene=21#wechat_redirect)。

我简单摘录以下 6 个流程：

1.  浏览器向 DNS 服务器请求解析该 URL 中的域名所对应的 IP 地址;
    
2.  解析出 IP 地址后，根据该 IP 地址和端口 8080(没有的话 http 默认 80，https 默认是 443 端口)，和服务器建立 TCP 连接;
    
3.  浏览器发出读取文件 (URL 中域名后面部分对应的文件) 的 HTTP 请求，该请求报文作为 TCP 三次握手的第三个报文的数据发送给服务器;
    
4.  服务器对浏览器请求作出响应，并把对应的 html 文本发送给浏览器;
    
5.  释放 TCP 连接;
    
6.  浏览器将该 html 文本并显示内容
    

可以很明显的看到，我们是先找 ip，找到 ip 后，再去找端口，找到端口后，才能使用指定协议进行通信。

所以，端口的优先级是高于具体的协议的。不管你是 https、http、ftp、file 等协议。

好了，现在我假设让你实现这个功能，你会如何实现指定端口优先？

这点可以参考 JVM 参数的实现，当你指定参数后，使用你指定的参数，不指定时使用默认参数。

大道至简，今天就聊这么多吧 (就水这么多)。已加入星球的，欢迎微信私我，加入星球群。

