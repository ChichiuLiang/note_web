> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/orJ2tiLjRzdnpuUGfUnF1A)

点击“IT码徒”，关注，置顶公众号

```
每日技术干货，第一时间送达！

```

  

*   优点
    

*   性能强大
    
*   统计信息详细
    
*   使用场景丰富
    

*   性能
    

*   HTTP 每秒新建连接数
    
*   HTTP 吞吐
    
*   HTTP 并发连接数
    
*   UDP TX PPS
    

*   测试环境配置
    
*   统计数据
    
*   开始使用
    

*   设置大页
    
*   编译 DPDK
    
*   编译 dperf
    
*   绑定网卡
    
*   启动 dperf server
    
*   从客户端发送请求
    
*   运行测试
    
*   开源地址
    

  

* * *

dperf 是一款基于 DPDK 的 100Gbps 网络性能和负载测试软件，能够每秒建立千万级的 HTTP 连接、亿级别的并发请求和数百 Gbps 的吞吐量。

**优点**
------

### 性能强大：

*   基于 DPDK，使用一台普通 x86 服务器就可以产生巨大的流量：千万级的 HTTP 每秒新建连接数，数百 Gbps 的带宽，几十亿的并发连接数
    

### 统计信息详细：

*   能够输出详细的统计信息，并且识别每一个丢包
    

### 使用场景丰富：

*   可用于对四层负载均衡等四层网关进行性能压力测试、长稳测试
    
*   可用于对云上虚拟机的网络性能进行测试
    
*   可用于对网卡性能、CPU 的网络报文处理能力进行测试
    
*   压测场景下，可作为高性能的 HTTP Server 或 HTTP Client 单独使用
    

**性能**
------

### HTTP 每秒新建连接数

<table width="657"><thead style="outline: 0px;"><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204);" class="js_darkmode__49"><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__50">Client Cores</th><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__51">Server Cores</th><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__52">HTTP CPS</th></tr></thead><tbody style="outline: 0px;border-width: 0px;border-style: initial;border-color: initial;"><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204);" class="js_darkmode__53"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__54">1</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__55">1</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__56">2,101,044</td></tr><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: rgb(248, 248, 248);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: rgb(248, 248, 248);" class="js_darkmode__57"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__58">2</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__59">2</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__60">4,000,423</td></tr><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204);" class="js_darkmode__61"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__62">4</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__63">4</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__64">7,010,743</td></tr><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: rgb(248, 248, 248);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: rgb(248, 248, 248);" class="js_darkmode__65"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__66">6</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__67">6</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__68">10,027,172</td></tr></tbody></table>

### HTTP 吞吐

<table width="657"><thead style="outline: 0px;"><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204);" class="js_darkmode__71"><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__72">Client Cores</th><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__73">Server Cores</th><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__74">RX(Gbps)</th><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__75">TX(Gbps)</th><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__76">Client CPU Usage(%)</th><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__77">Server CPU Usage(%)</th></tr></thead><tbody style="outline: 0px;border-width: 0px;border-style: initial;border-color: initial;"><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204);" class="js_darkmode__78"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__79">1</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__80">1</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__81">18</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__82">18</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__83">60</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__84">59</td></tr><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: rgb(248, 248, 248);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: rgb(248, 248, 248);" class="js_darkmode__85"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__86">2</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__87">2</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__88">35</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__89">35</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__90">60</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__91">59</td></tr><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204);" class="js_darkmode__92"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__93">4</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__94">4</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__95">46</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__96">46</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__97">43</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__98">43</td></tr></tbody></table>

### HTTP 并发连接数

<table width="657"><thead style="outline: 0px;"><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204);" class="js_darkmode__101"><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__102">Client Cores</th><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__103">Server Cores</th><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__104">Current Connections</th><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__105">Client CPU Usage(%)</th><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__106">Server CPU Usage(%)</th></tr></thead><tbody style="outline: 0px;border-width: 0px;border-style: initial;border-color: initial;"><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204);" class="js_darkmode__107"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__108">1</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__109">1</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__110">100,000,000</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__111">34</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__112">39</td></tr><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: rgb(248, 248, 248);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: rgb(248, 248, 248);" class="js_darkmode__113"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__114">2</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__115">2</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__116">200,000,000</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__117">36</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__118">39</td></tr><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204);" class="js_darkmode__119"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__120">4</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__121">4</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__122">400,000,000</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__123">40</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__124">41</td></tr></tbody></table>

### UDP TX PPS

<table width="657"><thead style="outline: 0px;"><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204);" class="js_darkmode__127"><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__128">Client Cores</th><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__129">TX MPPS</th><th style="outline: 0px;word-break: break-all;hyphens: auto;border-top-width: 1px;border-color: rgb(204, 204, 204);background-color: rgb(240, 240, 240);font-size: 14px;min-width: 85px;text-align: left;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-top-width: 1px; border-color: rgb(204, 204, 204); background-color: rgb(240, 240, 240); font-size: 14px; min-width: 85px; text-align: left;" class="js_darkmode__130">Client CPU Usage(%)</th></tr></thead><tbody style="outline: 0px;border-width: 0px;border-style: initial;border-color: initial;"><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204);" class="js_darkmode__131"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__132">1</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__133">15.96</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__134">95</td></tr><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: rgb(248, 248, 248);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: rgb(248, 248, 248);" class="js_darkmode__135"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__136">2</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__137">29.95</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__138">95</td></tr><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204);" class="js_darkmode__139"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__140">4</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__141">34.92</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__142">67</td></tr><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: rgb(248, 248, 248);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: rgb(248, 248, 248);" class="js_darkmode__143"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__144">6</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__145">35.92</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__146">54</td></tr><tr style="outline: 0px;border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);" data-style="outline: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204);" class="js_darkmode__147"><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__148">8</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__149">37.12</td><td style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(204, 204, 204);font-size: 14px;min-width: 85px;" data-style="outline: 0px; word-break: break-all; hyphens: auto; border-color: rgb(204, 204, 204); font-size: 14px; min-width: 85px;" class="js_darkmode__150">22</td></tr></tbody></table>

**测试环境配置**
----------

dperf 的以上性能数据，基于下面的配置测试得到：

*   内存: 512GB(大页 100GB)
    
*   网卡: Mellanox MT27710 25Gbps * 2
    
*   内核: 4.19.90
    

**统计数据**
--------

dperf 每秒输出多种统计数据：

*   TPS, CPS, 各种维度的 PPS
    
*   TCP/Socket/HTTP 级别的错误数
    
*   丢包数
    
*   按照 TCP Flag 分类的报文重传数
    

```
seconds 22                 cpuUsage 52  
pktRx   3,001,058          pktTx    3,001,025          bitsRx   2,272,799,040      bitsTx  1,920,657,600      dropTx  0  
arpRx   0                  arpTx    0                  icmpRx   0                  icmpTx  0                  otherRx 0          badRx 0  
synRx   1,000,345          synTx    1,000,330          finRx    1,000,350          finTx   1,000,350          rstRx   0          rstTx 0  
synRt   0                  finRt    0                  ackRt    0                  pushRt  0                  tcpDrop 0  
skOpen  1,000,330          skClose  1,000,363          skCon    230                skErr   0  
httpGet 1,000,345          http2XX  1,000,350          httpErr  0  
ierrors 0                  oerrors  0                  imissed  0  


```

**开始使用**
--------

### 设置大页

```
#参考如下参数编辑 '/boot/grub2/grub.cfg'，然后重启OS  
linux16 /vmlinuz-... nopku transparent_hugepage=never default_hugepagesz=1G hugepagesz=1G hugepages=8  


```

### 编译 DPDK

```
#编辑'config/common_base'打开PMD开关  
#Mellanox CX4/CX5 requires 'CONFIG_RTE_LIBRTE_MLX5_PMD=y'  
#HNS3 requires 'CONFIG_RTE_LIBRTE_HNS3_PMD=y'  
#VMXNET3 requires 'CONFIG_RTE_LIBRTE_VMXNET3_PMD=y'  
  
TARGET=x86_64-native-linuxapp-gcc #or arm64-armv8a-linuxapp-gcc  
cd /root/dpdk/dpdk-stable-19.11.10  
make install T=$TARGET -j16  


```

### 编译 dperf

```
cd dperf  
make -j8 RTE_SDK=/root/dpdk/dpdk-stable-19.11.10 RTE_TARGET=$TARGET  


```

### 绑定网卡

```
#Mellanox网卡跳过此步  
#假设PCI号是0000:1b:00.0  
  
modprobe uio  
modprobe uio_pci_generic  
/root/dpdk/dpdk-stable-19.11.10/usertools/dpdk-devbind.py -b uio_pci_generic 0000:1b:00.0  


```

### 启动 dperf server

```
#dperf server监听6.6.241.27:80, 网关是6.6.241.1  
./build/dperf -c test/http/server-cps.conf  


```

### 从客户端发送请求

```
#客户端IP必须要在配置文件的'client'范围内  
ping 6.6.241.27  
curl http://6.6.241.27/  


```

### 运行测试

下面的例子运行一个 HTTP CPS 压力测试。在 server 端运行 dperf ./build/dperf -c test/http/server-cps.conf

```
#以另一台机器作为client端，运行dperf  
./build/dperf -c test/http/client-cps.conf  


```

### 开源地址

> *   https://github.com/baidu/dperf
>     

  

—END—

  

[【福利】2023 高薪课程，全面来袭（视频+笔记+源码）](http://mp.weixin.qq.com/s?__biz=MzU2OTMyMTAxNA==&mid=2247516711&idx=1&sn=e54d98dc55dd5dd2ff2c90935a60ae97&chksm=fc82b17ecbf53868aece859626913a43ba5b592398dcda1847e497df47632b180fb1fbd3a3d3&scene=21#wechat_redirect)
=====================================================================================================================================================================================================================================================

  

**PS：防止找不到本篇文章，可以收藏点赞，方便翻阅查找哦。**

  

  

往期推荐

  

  

[

什么是流式SQL，它有什么用？



](http://mp.weixin.qq.com/s?__biz=MzI3MDM0MzAyMg==&mid=2247506860&idx=2&sn=8086c78f9d599e02773ea4d757f34f0c&chksm=ead015addda79cbb17d98c7e059ada00d0328d443ae2e0af64b16147a60c568c2fdc86786467&scene=21#wechat_redirect)

[

maven 实战总结，工作中常见操作！



](http://mp.weixin.qq.com/s?__biz=MzI3MDM0MzAyMg==&mid=2247506846&idx=2&sn=a2a708ebdef119922315c57f1f01a643&chksm=ead0159fdda79c893a874dc0a84cc6c5ac230b66c38868097051463af66efb7b06f1d94c311c&scene=21#wechat_redirect)

[

在 Docker 中跑 MySQL？恭喜你，要下岗了



](http://mp.weixin.qq.com/s?__biz=MzI3MDM0MzAyMg==&mid=2247506832&idx=1&sn=83484a91f9e7c1bb89aa2f17b7b590ed&chksm=ead01591dda79c876d819659002d655401f682a40d32d10153d0a0ae72a361579173da5b971c&scene=21#wechat_redirect)

[

你见过最烂的代码长什么样子？挺好，防止忘记密码，大隐隐于市



](http://mp.weixin.qq.com/s?__biz=MzI3MDM0MzAyMg==&mid=2247506823&idx=1&sn=c038a9d99f78911dd887edb88165c39c&chksm=ead01586dda79c909f2be0ddbe1cd13e7f08a39a51a445452b6bd2f558068c6edcc72f404cef&scene=21#wechat_redirect)

[

开源项目 ｜ 一个开源、高颜值的 Web 文件管理器



](http://mp.weixin.qq.com/s?__biz=MzI3MDM0MzAyMg==&mid=2247506823&idx=2&sn=5c46903874739d0ecd1b5ea11d28a2c5&chksm=ead01586dda79c90ab9f12c11c405a90c816aab3a60f3f6419c323cdb80f5392845c47533944&scene=21#wechat_redirect)

[

进阶玩法：策略+责任链+组合实现合同签章



](http://mp.weixin.qq.com/s?__biz=MzI3MDM0MzAyMg==&mid=2247506806&idx=1&sn=010b7ca3312028f2f842e089b85cdad5&chksm=ead01577dda79c61ee2baca796510769abb2ee7cec67b8ee20f8f9d99e6eff353579f9265c1c&scene=21#wechat_redirect)